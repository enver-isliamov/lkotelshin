# Инструкция по настройке Google Apps Script API

Это самый надежный способ подключить ваше приложение к Google Таблице. Следуйте этим шагам внимательно.

### Шаг 1: Откройте редактор скриптов

1.  Откройте вашу Google Таблицу: [ссылка](https://docs.google.com/spreadsheets/d/1IBBn38ZD-TOgzO9VjYAyKz8mchg_RwWyD6kZ0Lu729A/edit)
2.  В верхнем меню выберите `Расширения` (Extensions) -> `Apps Script`.

    

### Шаг 2: Вставьте код скрипта

1.  Откроется новая вкладка с редактором кода. Полностью **удалите** весь код, который там есть по умолчанию (`function myFunction() { ... }`).
2.  Скопируйте **весь** код из файла `apps_script/Code.js`.
3.  Вставьте скопированный код в пустое поле редактора.
4.  Нажмите на иконку дискеты (`Сохранить проект`) вверху. Можете дать проекту любое имя, например, "Client Cabinet API".

    

### Шаг 3: Опубликуйте скрипт как веб-приложение

1.  В правом верхнем углу редактора нажмите синюю кнопку `Развертывание` (Deploy) -> `Новое развертывание` (New deployment).

    

2.  Откроется окно настроек. Нажмите на иконку шестеренки (`Выбрать тип`) и выберите `Веб-приложение` (Web app).

    

3.  Заполните поля:
    *   **Описание (Description):** (Необязательно) Можете написать "API для личного кабинета".
    *   **Выполнять как (Execute as):** Оставьте `Я` (Me).
    *   **Кто имеет доступ (Who has access):** **ЭТО САМЫЙ ВАЖНЫЙ ШАГ!** Измените значение с `Только я` (Only myself) на `Все` (Anyone). **Если этого не сделать, приложение не сможет получить данные.**

    

4.  Нажмите кнопку `Развернуть` (Deploy).

### Шаг 4: Предоставьте разрешения

1.  Google попросит вас предоставить разрешения для скрипта на доступ к вашим таблицам. Это безопасно, так как вы даете доступ своему собственному скрипту.
2.  Нажмите `Предоставить доступ` (Authorize access).
3.  Выберите свой аккаунт Google.
4.  Вы можете увидеть предупреждение "Google не проверял это приложение". Это нормально. Нажмите `Дополнительные настройки` (Advanced), а затем `Перейти на страницу ... (небезопасно)` (Go to ... (unsafe)).
5.  Нажмите `Разрешить` (Allow) на следующем экране.

### Шаг 5: Скопируйте URL вашего API

1.  После успешного развертывания появится окно с **URL веб-приложения**.
2.  Нажмите кнопку `Копировать` (Copy) рядом с этим URL. **Этот URL — ваш ключ к данным.**

    

### Шаг 6: Вставьте URL в код приложения

1.  Откройте файл `src/constants.ts` в вашем проекте.
2.  Найдите строку `export const APPS_SCRIPT_URL = 'ВАШ_URL_СКРИПТА';`
3.  Замените `'ВАШ_URL_СКРИПТА'` на URL, который вы скопировали на предыдущем шаге. Убедитесь, что URL находится внутри кавычек.

    **Пример:**
    ```typescript
    export const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycb.../exec';
    ```

4.  Сохраните файл.

**Готово!** Теперь ваше приложение будет работать быстро и стабильно, без ошибок загрузки данных.


# Инструкция по настройке Google Apps Script API

Это самый надежный способ подключить ваше приложение к Google Таблице. Следуйте этим шагам внимательно.

### Шаг 1: Откройте редактор скриптов

1.  Откройте вашу Google Таблицу: [ссылка](https://docs.google.com/spreadsheets/d/1IBBn38ZD-TOgzO9VjYAyKz8mchg_RwWyD6kZ0Lu729A/edit)
2.  В верхнем меню выберите `Расширения` (Extensions) -> `Apps Script`.

    

### Шаг 2: Вставьте код скрипта

1.  Откроется новая вкладка с редактором кода. Полностью **удалите** весь код, который там есть по умолчанию (`function myFunction() { ... }`).
2.  Скопируйте **весь** код из файла `apps_script/Code.js`.
3.  Вставьте скопированный код в пустое поле редактора.
4.  Нажмите на иконку дискеты (`Сохранить проект`) вверху. Можете дать проекту любое имя, например, "Client Cabinet API".

### Шаг 3: Создайте лист для конфигурации

1. Вернитесь во вкладку с вашей Google Таблицей.
2. В левом нижнем углу нажмите на плюсик (`+`), чтобы добавить новый лист.
3. Дважды кликните на название нового листа (`ЛистN`) и переименуйте его в `Config`. **Название должно быть точь-в-точь таким, с большой буквы.**
4. В ячейку **A1** напишите `Key`.
5. В ячейку **B1** напишите `Value`.

Это необходимо для того, чтобы администратор мог сохранять настройки видимых полей прямо из приложения.

    

### Шаг 4: Опубликуйте скрипт как веб-приложение

1.  Вернитесь в редактор Apps Script. В правом верхнем углу нажмите синюю кнопку `Развертывание` (Deploy) -> `Новое развертывание` (New deployment).

    

2.  Откроется окно настроек. Нажмите на иконку шестеренки (`Выбрать тип`) и выберите `Веб-приложение` (Web app).

    

3.  Заполните поля:
    *   **Описание (Description):** (Необязательно) Можете написать "API для личного кабинета".
    *   **Выполнять как (Execute as):** Оставьте `Я` (Me).
    *   **Кто имеет доступ (Who has access):** **ЭТО САМЫЙ ВАЖНЫЙ ШАГ!** Измените значение с `Только я` (Only myself) на `Все` (Anyone). **Если этого не сделать, приложение не сможет получить данные.**

    

4.  Нажмите кнопку `Развернуть` (Deploy).

### Шаг 5: Предоставьте разрешения

1.  Google попросит вас предоставить разрешения для скрипта на доступ к вашим таблицам. Это безопасно, так как вы даете доступ своему собственному скрипту.
2.  Нажмите `Предоставить доступ` (Authorize access).
3.  Выберите свой аккаунт Google.
4.  Вы можете увидеть предупреждение "Google не проверял это приложение". Это нормально. Нажмите `Дополнительные настройки` (Advanced), а затем `Перейти на страницу ... (небезопасно)` (Go to ... (unsafe)).
5.  Нажмите `Разрешить` (Allow) на следующем экране.

### Шаг 6: Скопируйте URL вашего API

1.  После успешного развертывания появится окно с **URL веб-приложения**.
2.  Нажмите кнопку `Копировать` (Copy) рядом с этим URL. **Этот URL — ваш ключ к данным.**

    

### Шаг 7: Вставьте URL в код приложения

1.  Откройте файл `src/constants.ts` в вашем проекте.
2.  Найдите строку `export const APPS_SCRIPT_URL = 'ВАШ_URL_СКРИПТА';`
3.  Замените `'ВАШ_URL_СКРИПТА'` на URL, который вы скопировали на предыдущем шаге. Убедитесь, что URL находится внутри кавычек.

    **Пример:**
    ```typescript
    export const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycb.../exec';
    ```

4.  Сохраните файл.

### Шаг 8: Обновление скрипта (ВАЖНО!)

Если вы вносите какие-либо изменения в код в редакторе Apps Script (файл `Code.js`), простого сохранения **недостаточно**. Чтобы изменения вступили в силу, вам нужно опубликовать новую версию:

1.  Нажмите `Развертывание` (Deploy) -> `Управление развертываниями` (Manage deployments).
2.  Найдите ваше активное развертывание и нажмите на иконку **карандаша** (Редактировать).
3.  В выпадающем списке `Версия` (Version) выберите `Новая версия` (New version).
4.  Нажмите кнопку `Развернуть` (Deploy).

Только после этого ваши изменения в бэкенде станут доступны для приложения.

**Готово!** Теперь ваше приложение будет работать быстро и стабильно, а конфигурацией можно управлять прямо из панели администратора.
